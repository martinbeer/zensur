<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pressefreiheitsindex 2025 - Weltkarte</title>    <!-- Leaflet CSS und JS f√ºr OpenStreetMap -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- SheetJS f√ºr Excel-Dateien -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        *::-webkit-scrollbar {
            display: none;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            overflow: hidden;
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
        }

        .container {
            width: 100vw;
            height: 100vh;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 0;
            max-width: 95vw;
            max-height: 95vh;
            width: 95vw;
            height: 95vh;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .modal-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px 30px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .close-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            height: calc(95vh - 80px);
            display: flex;
            gap: 0;
            overflow: hidden;
        }

        /* Map specific styles */
        #pressmap {
            flex: 1;
            background: white;
        }

        #modal-worldmap .modal-body > div {
            overflow: hidden;
        }

        #modal-worldmap .globe-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #modal-worldmap .modal-body ul li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }

        #modal-worldmap .modal-body h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }        #modal-worldmap .modal-body > div > div {
            padding: 20px;
        }

        /* Flash animation for table rows */
        @keyframes flash {
            0% { background-color: #e3f2fd; }
            50% { background-color: #2196f3; color: white; }
            100% { background-color: #e3f2fd; }
        }

        /* Hover effect for table rows */
        .ranking-row:hover {
            background-color: #f5f5f5 !important;
        }
    </style>

    <div class="container">
        <!-- Modal f√ºr Weltkarte -->
        <div class="modal-overlay active" id="modal-worldmap">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">üó∫Ô∏è Pressefreiheitsindex 2025 - Reporter ohne Grenzen</h2>
                    <button class="close-btn" onclick="goBackToMain()">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Karte links -->
                    <div style="flex: 2; background: #f8f9fa; display: flex; flex-direction: column;">
                        <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 15px; text-align: center;">
                            <h3 style="margin: 0; font-size: 1.2rem;">Interaktive Weltkarte</h3>
                            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.9;">Klicke auf L√§nder f√ºr Details</p>
                        </div>
                        <div id="pressmap" style="flex: 1; background: white;"></div>
                    </div>
                    <!-- Rangliste rechts -->
                    <div style="width: 400px; background: white; display: flex; flex-direction: column; border-left: 1px solid #ddd;">
                        <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 15px; text-align: center;">
                            <h3 style="margin: 0; font-size: 1.2rem;">üìä Vollst√§ndige Rangliste</h3>
                            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.9;">Alle 180 L√§nder</p>
                        </div>
                        <div style="flex: 1; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none;">
                            <style>
                            div[style*="overflow-y: auto"]::-webkit-scrollbar { display: none; }
                            </style>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: #f8f9fa; position: sticky; top: 0;">
                                        <th style="padding: 10px 8px; text-align: center; font-size: 0.85rem; width: 50px;">Rang</th>
                                        <th style="padding: 10px 8px; text-align: left; font-size: 0.85rem;">Land</th>
                                        <th style="padding: 10px 8px; text-align: center; font-size: 0.85rem; width: 60px;">Score</th>
                                    </tr>
                                </thead>
                                <tbody id="ranking-tbody-modal">
                                    <!-- Wird mit JavaScript gef√ºllt -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>        // Globale Variablen
        let pressMap = null;
        let countries = []; // Will be loaded from Excel file        // Function to load data from Excel file
        async function loadRSFData() {
            try {
                console.log('üîÑ Loading RSF data from Excel file...');
                const response = await fetch('RSF_Rangliste_der_Pressefreiheit_2025_Details.xlsx');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                // Assume the data is in the first sheet
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                
                console.log('üìä Raw Excel data:', jsonData);
                console.log('üìã Available columns:', Object.keys(jsonData[0] || {}));                // Fallback coordinates for major countries (if not in Excel)
                const countryCoordinates = {
                    'Deutschland': { lat: 51.1657, lng: 10.4515 },
                    'Norway': { lat: 60.472, lng: 8.4689 },
                    'Norwegen': { lat: 60.472, lng: 8.4689 },
                    'Denmark': { lat: 56.2639, lng: 9.5018 },
                    'D√§nemark': { lat: 56.2639, lng: 9.5018 },
                    'Sweden': { lat: 60.1282, lng: 18.6435 },
                    'Schweden': { lat: 60.1282, lng: 18.6435 },
                    'Finland': { lat: 61.9241, lng: 25.7482 },
                    'Finnland': { lat: 61.9241, lng: 25.7482 },
                    'Netherlands': { lat: 52.1326, lng: 5.2913 },
                    'Niederlande': { lat: 52.1326, lng: 5.2913 },
                    'United States': { lat: 37.0902, lng: -95.7129 },
                    'USA': { lat: 37.0902, lng: -95.7129 },
                    'China': { lat: 35.8617, lng: 104.1954 },
                    'Russia': { lat: 61.5240, lng: 105.3188 },
                    'Russland': { lat: 61.5240, lng: 105.3188 },
                    'United Kingdom': { lat: 55.3781, lng: -3.4360 },
                    'Vereinigtes K√∂nigreich': { lat: 55.3781, lng: -3.4360 },
                    'France': { lat: 46.6034, lng: 1.8883 },
                    'Frankreich': { lat: 46.6034, lng: 1.8883 },
                    'Italy': { lat: 41.8719, lng: 12.5674 },
                    'Italien': { lat: 41.8719, lng: 12.5674 },
                    'Spain': { lat: 40.4637, lng: -3.7492 },
                    'Spanien': { lat: 40.4637, lng: -3.7492 },
                    'Belgium': { lat: 50.5039, lng: 4.4699 },
                    'Belgien': { lat: 50.5039, lng: 4.4699 },
                    'Austria': { lat: 47.5162, lng: 14.5501 },
                    '√ñsterreich': { lat: 47.5162, lng: 14.5501 },
                    'Switzerland': { lat: 46.8182, lng: 8.2275 },
                    'Schweiz': { lat: 46.8182, lng: 8.2275 },
                    'Poland': { lat: 51.9194, lng: 19.1451 },
                    'Polen': { lat: 51.9194, lng: 19.1451 },
                    'Portugal': { lat: 39.3999, lng: -8.2245 },
                    'Ireland': { lat: 53.1424, lng: -7.6921 },
                    'Irland': { lat: 53.1424, lng: -7.6921 },
                    'Czech Republic': { lat: 49.8175, lng: 15.473 },
                    'Tschechien': { lat: 49.8175, lng: 15.473 },
                    'Hungary': { lat: 47.1625, lng: 19.5033 },
                    'Ungarn': { lat: 47.1625, lng: 19.5033 },
                    'Slovakia': { lat: 48.669, lng: 19.699 },
                    'Slowakei': { lat: 48.669, lng: 19.699 },
                    'Slovenia': { lat: 46.1512, lng: 14.9955 },
                    'Slowenien': { lat: 46.1512, lng: 14.9955 },
                    'Estonia': { lat: 58.5953, lng: 25.0136 },
                    'Estland': { lat: 58.5953, lng: 25.0136 },
                    'Latvia': { lat: 56.8796, lng: 24.6032 },
                    'Lettland': { lat: 56.8796, lng: 24.6032 },
                    'Lithuania': { lat: 55.1694, lng: 23.8813 },
                    'Litauen': { lat: 55.1694, lng: 23.8813 },
                    'Romania': { lat: 45.9432, lng: 24.9668 },
                    'Rum√§nien': { lat: 45.9432, lng: 24.9668 },
                    'Bulgaria': { lat: 42.7339, lng: 25.4858 },
                    'Bulgarien': { lat: 42.7339, lng: 25.4858 },
                    'Croatia': { lat: 45.1, lng: 15.2 },
                    'Kroatien': { lat: 45.1, lng: 15.2 },
                    'Serbia': { lat: 44.0165, lng: 21.0059 },
                    'Serbien': { lat: 44.0165, lng: 21.0059 },
                    'Greece': { lat: 39.0742, lng: 21.8243 },
                    'Griechenland': { lat: 39.0742, lng: 21.8243 },
                    'Turkey': { lat: 38.9637, lng: 35.2433 },
                    'T√ºrkei': { lat: 38.9637, lng: 35.2433 },
                    'Ukraine': { lat: 48.3794, lng: 31.1656 },
                    'Belarus': { lat: 53.7098, lng: 27.9534 },
                    'Wei√ürussland': { lat: 53.7098, lng: 27.9534 },
                    'Moldova': { lat: 47.4116, lng: 28.3699 },
                    'Moldau': { lat: 47.4116, lng: 28.3699 },
                    'Canada': { lat: 56.1304, lng: -106.3468 },
                    'Kanada': { lat: 56.1304, lng: -106.3468 },
                    'Mexico': { lat: 23.6345, lng: -102.5528 },
                    'Mexiko': { lat: 23.6345, lng: -102.5528 },
                    'Brazil': { lat: -14.235, lng: -51.9253 },
                    'Brasilien': { lat: -14.235, lng: -51.9253 },
                    'Argentina': { lat: -38.4161, lng: -63.6167 },
                    'Argentinien': { lat: -38.4161, lng: -63.6167 },
                    'Chile': { lat: -35.6751, lng: -71.543 },
                    'Japan': { lat: 36.2048, lng: 138.2529 },
                    'South Korea': { lat: 35.9078, lng: 127.7669 },
                    'S√ºdkorea': { lat: 35.9078, lng: 127.7669 },
                    'Australia': { lat: -25.2744, lng: 133.7751 },
                    'Australien': { lat: -25.2744, lng: 133.7751 },
                    'New Zealand': { lat: -40.9006, lng: 174.886 },
                    'Neuseeland': { lat: -40.9006, lng: 174.886 },
                    'India': { lat: 20.5937, lng: 78.9629 },
                    'Indien': { lat: 20.5937, lng: 78.9629 },
                    'Pakistan': { lat: 30.3753, lng: 69.3451 },
                    'Bangladesh': { lat: 23.685, lng: 90.3563 },
                    'Thailand': { lat: 15.87, lng: 100.9925 },
                    'Vietnam': { lat: 14.0583, lng: 108.2772 },
                    'Indonesia': { lat: -0.7893, lng: 113.9213 },
                    'Indonesien': { lat: -0.7893, lng: 113.9213 },
                    'Malaysia': { lat: 4.2105, lng: 101.9758 },
                    'Philippines': { lat: 13.41, lng: 122.56 },
                    'Philippinen': { lat: 13.41, lng: 122.56 },
                    'South Africa': { lat: -30.5595, lng: 22.9375 },
                    'S√ºdafrika': { lat: -30.5595, lng: 22.9375 },
                    'Nigeria': { lat: 9.082, lng: 8.6753 },
                    'Kenya': { lat: -0.0236, lng: 37.9062 },
                    'Kenia': { lat: -0.0236, lng: 37.9062 },
                    'Egypt': { lat: 26.0975, lng: 31.2357 },
                    '√Ñgypten': { lat: 26.0975, lng: 31.2357 },                    'Morocco': { lat: 31.7917, lng: -7.0926 },
                    'Marokko / Westsahara': { lat: 31.7917, lng: -7.0926 }, // Morocco in German
                    'Maroc': { lat: 31.7917, lng: -7.0926 }, // French name
                    'Kingdom of Morocco': { lat: 31.7917, lng: -7.0926 }, // Official name
                    'K√∂nigreich Marokko': { lat: 31.7917, lng: -7.0926 }, // Official German name
                    'Algeria': { lat: 28.0339, lng: 1.6596 },
                    'Algerien': { lat: 28.0339, lng: 1.6596 },
                    'Tunisia': { lat: 33.8869, lng: 9.5375 },
                    'Tunesien': { lat: 33.8869, lng: 9.5375 },
                    'Iran': { lat: 32.4279, lng: 53.688 },
                    'Saudi Arabia': { lat: 23.8859, lng: 45.0792 },
                    'Saudi-Arabien': { lat: 23.8859, lng: 45.0792 },
                    'Israel': { lat: 31.0461, lng: 34.8516 },
                    'Jordan': { lat: 30.5852, lng: 36.2384 },
                    'Jordanien': { lat: 30.5852, lng: 36.2384 },
                    'Lebanon': { lat: 33.8547, lng: 35.8623 },
                    'Libanon': { lat: 33.8547, lng: 35.8623 },
                    'Syria': { lat: 34.8021, lng: 38.9968 },
                    'Syrien': { lat: 34.8021, lng: 38.9968 },
                    'Iraq': { lat: 33.2232, lng: 43.6793 },
                    'Irak': { lat: 33.2232, lng: 43.6793 },
                    // Additional countries to ensure all 180 are covered
                    'Afghanistan': { lat: 33.9391, lng: 67.7100 },
                    'Albania': { lat: 41.1533, lng: 20.1683 },
                    'Angola': { lat: -11.2027, lng: 17.8739 },                    'Armenia': { lat: 40.0691, lng: 45.0382 },
                    'Armenien': { lat: 40.0691, lng: 45.0382 }, // Armenia in German
                    'Azerbaijan': { lat: 40.1431, lng: 47.5769 },
                    'Aserbaidschan': { lat: 40.1431, lng: 47.5769 }, // Azerbaijan in German
                    'Bahrain': { lat: 26.0667, lng: 50.5577 },
                    'Benin': { lat: 9.3077, lng: 2.3158 },
                    'Bolivia': { lat: -16.2902, lng: -63.5887 },
                    'Bolivien': { lat: -16.2902, lng: -63.5887 }, // Bolivia in German
                    'Bosnia and Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnia & Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnia-Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnien und Herzegowina': { lat: 43.9159, lng: 17.6791 }, // German
                    'Bosnien-Herzegowina': { lat: 43.9159, lng: 17.6791 }, // German short
                    'Bosnia': { lat: 43.9159, lng: 17.6791 }, // Short form
                    'Bosnien': { lat: 43.9159, lng: 17.6791 }, // German short
                    'Botswana': { lat: -22.3285, lng: 24.6849 },
                    'Burkina Faso': { lat: 12.2383, lng: -1.5616 },
                    'Cambodia': { lat: 12.5657, lng: 104.9910 },
                    'Cameroon': { lat: 7.3697, lng: 12.3547 },
                    'Central African Republic': { lat: 6.6111, lng: 20.9394 },
                    'Chad': { lat: 15.4542, lng: 18.7322 },
                    'Colombia': { lat: 4.5709, lng: -74.2973 },
                    'Costa Rica': { lat: 9.7489, lng: -83.7534 },
                    'Cuba': { lat: 21.5218, lng: -77.7812 },
                    'Cyprus': { lat: 35.1264, lng: 33.4299 },
                    'Dominican Republic': { lat: 18.7357, lng: -70.1627 },
                    'Dominikanische Republik': { lat: 18.7357, lng: -70.1627 }, // German
                    'Ecuador': { lat: -1.8312, lng: -78.1834 },
                    'El Salvador': { lat: 13.7942, lng: -88.8965 },
                    'Ethiopia': { lat: 9.1450, lng: 40.4897 },
                    'Fiji': { lat: -16.5750, lng: 179.4144 },
                    'Fidschi': { lat: -16.5750, lng: 179.4144 }, // Fiji in German
                    'Dominikanische Republik': { lat: 18.7357, lng: -70.1627 }, // Dominican Republic in German                    'OECS': { lat: 14.0, lng: -61.0 }, // Organization of Eastern Caribbean States
                    'Ostkaribik': { lat: 14.0, lng: -61.0 }, // Eastern Caribbean in German
                    // Additional missing countries
                    'Republic of Congo': { lat: -0.2280, lng: 15.8277 },
                    'Republik Kongo': { lat: -0.2280, lng: 15.8277 }, // German
                    'Congo Republic': { lat: -0.2280, lng: 15.8277 },
                    'Congo-Brazzaville': { lat: -0.2280, lng: 15.8277 },
                    'Comoros': { lat: -11.6455, lng: 43.3333 },
                    'Komoren': { lat: -11.6455, lng: 43.3333 }, // German
                    'Cyprus': { lat: 35.1264, lng: 33.4299 },
                    'Zypern': { lat: 35.1264, lng: 33.4299 }, // German
                    'Northern Cyprus': { lat: 35.2833, lng: 33.3833 },
                    'Nordzypern': { lat: 35.2833, lng: 33.3833 }, // German
                    'Turkish Republic of Northern Cyprus': { lat: 35.2833, lng: 33.3833 },
                    'Qatar': { lat: 25.3548, lng: 51.1839 },
                    'Katar': { lat: 25.3548, lng: 51.1839 }, // German
                    'Albania': { lat: 41.1533, lng: 20.1683 },
                    'Albanien': { lat: 41.1533, lng: 20.1683 }, // German
                    'Kosovo': { lat: 42.6026, lng: 20.9030 },
                    'Maldives': { lat: 3.2028, lng: 73.2207 },
                    'Malediven': { lat: 3.2028, lng: 73.2207 }, // German
                    'Madagascar': { lat: -18.7669, lng: 46.8691 },
                    'Madagaskar': { lat: -18.7669, lng: 46.8691 }, // German
                    'Colombia': { lat: 4.5709, lng: -74.2973 },
                    'Kolumbien': { lat: 4.5709, lng: -74.2973 }, // German
                    'Singapore': { lat: 1.3521, lng: 103.8198 },
                    'Singapur': { lat: 1.3521, lng: 103.8198 }, // German
                    'El Salvador': { lat: 13.7942, lng: -88.8965 },
                    'Salvador': { lat: 13.7942, lng: -88.8965 },
                    'Hong Kong': { lat: 22.3193, lng: 114.1694 },
                    'Hongkong': { lat: 22.3193, lng: 114.1694 }, // German
                    'Hong Kong SAR': { lat: 22.3193, lng: 114.1694 },
                    'Bangladesh': { lat: 23.685, lng: 90.3563 },
                    'Bangladesch': { lat: 23.685, lng: 90.3563 }, // German
                    'Yemen': { lat: 15.5527, lng: 48.5164 },
                    'Jemen': { lat: 15.5527, lng: 48.5164 }, // German
                    'Cambodia': { lat: 12.5657, lng: 104.9910 },
                    'Kambodscha': { lat: 12.5657, lng: 104.9910 }, // German
                    'Palestine': { lat: 31.9522, lng: 35.2332 },
                    'Pal√§stina': { lat: 31.9522, lng: 35.2332 }, // German
                    'Palestinian Territories': { lat: 31.9522, lng: 35.2332 },
                    'Pal√§stinensische Gebiete': { lat: 31.9522, lng: 35.2332 }, // German
                    'State of Palestine': { lat: 31.9522, lng: 35.2332 },                    'Cuba': { lat: 21.5218, lng: -77.7812 },
                    'Kuba': { lat: 21.5218, lng: -77.7812 }, // German
                    'Gabon': { lat: -0.8037, lng: 11.6094 },
                    'Gambia': { lat: 13.4432, lng: -15.3101 },
                    'Georgia': { lat: 42.3154, lng: 43.3569 },
                    'Ghana': { lat: 7.9465, lng: -1.0232 },
                    'Guatemala': { lat: 15.7835, lng: -90.2308 },
                    'Guinea': { lat: 9.9456, lng: -9.6966 },
                    'Haiti': { lat: 18.9712, lng: -72.2852 },
                    'Honduras': { lat: 15.2000, lng: -86.2419 },
                    'Iceland': { lat: 64.9631, lng: -19.0208 },
                    'Island': { lat: 64.9631, lng: -19.0208 }, // Iceland in German
                    'Jamaica': { lat: 18.1096, lng: -77.2975 },
                    'Jamaika': { lat: 18.1096, lng: -77.2975 }, // Jamaica in German
                    'Taiwan': { lat: 23.6978, lng: 120.9605 },
                    'Taiwan (Province of China)': { lat: 23.6978, lng: 120.9605 }, // UN designation
                    'Chinese Taipei': { lat: 23.6978, lng: 120.9605 }, // Olympic designation
                    'Republic of China': { lat: 23.6978, lng: 120.9605 }, // Official name
                    'Republik China': { lat: 23.6978, lng: 120.9605 }, // German
                    'Kazakhstan': { lat: 48.0196, lng: 66.9237 },
                    'Kasachstan': { lat: 48.0196, lng: 66.9237 }, // Kazakhstan in German
                    'Kazakstan': { lat: 48.0196, lng: 66.9237 }, // Alternative spelling
                    'Kuwait': { lat: 29.3117, lng: 47.4818 },
                    'Kyrgyzstan': { lat: 41.2044, lng: 74.7661 },
                    'Kirgisistan': { lat: 41.2044, lng: 74.7661 }, // Kyrgyzstan in German
                    'Kirgistan': { lat: 41.2044, lng: 74.7661 }, // Alternative German spelling
                    'Laos': { lat: 19.8563, lng: 102.4955 },
                    'Libya': { lat: 26.3351, lng: 17.2283 },
                    'Luxembourg': { lat: 49.8153, lng: 6.1296 },
                    'Luxemburg': { lat: 49.8153, lng: 6.1296 }, // Luxembourg in German
                    'Madagascar': { lat: -18.7669, lng: 46.8691 },
                    'Mali': { lat: 17.5707, lng: -3.9962 },
                    'Malta': { lat: 35.9375, lng: 14.3754 },
                    'Mauritania': { lat: 21.0079, lng: -10.9408 },
                    'Mongolia': { lat: 46.8625, lng: 103.8467 },
                    'Montenegro': { lat: 42.7087, lng: 19.3744 },
                    'Myanmar': { lat: 21.9162, lng: 95.9560 },
                    'Namibia': { lat: -22.9576, lng: 18.4904 },
                    'Nepal': { lat: 28.3949, lng: 84.1240 },
                    'Nicaragua': { lat: 12.2651, lng: -85.2072 },
                    'Niger': { lat: 17.6078, lng: 8.0817 },
                    'North Korea': { lat: 40.3399, lng: 127.5101 },
                    'North Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'Oman': { lat: 21.4735, lng: 55.9754 },
                    'Panama': { lat: 8.5380, lng: -80.7821 },
                    'Papua New Guinea': { lat: -6.3140, lng: 143.9555 },
                    'Paraguay': { lat: -23.4425, lng: -58.4438 },
                    'Peru': { lat: -9.1900, lng: -75.0152 },
                    'Qatar': { lat: 25.3548, lng: 51.1839 },
                    'Rwanda': { lat: -1.9403, lng: 29.8739 },
                    'Senegal': { lat: 14.4974, lng: -14.4524 },
                    'Singapore': { lat: 1.3521, lng: 103.8198 },
                    'Somalia': { lat: 5.1521, lng: 46.1996 },
                    'Sri Lanka': { lat: 7.8731, lng: 80.7718 },
                    'Sudan': { lat: 12.8628, lng: 30.2176 },
                    'Suriname': { lat: 3.9193, lng: -56.0278 },
                    'Tajikistan': { lat: 38.8610, lng: 71.2761 },
                    'Tadschikistan': { lat: 38.8610, lng: 71.2761 }, // Tajikistan in German
                    'Tanzania': { lat: -6.3690, lng: 34.8888 },
                    'Togo': { lat: 8.6195, lng: 0.8248 },
                    'Trinidad and Tobago': { lat: 10.6918, lng: -61.2225 },
                    'Turkmenistan': { lat: 38.9697, lng: 59.5563 },
                    'Uganda': { lat: 1.3733, lng: 32.2903 },
                    'United Arab Emirates': { lat: 23.4241, lng: 53.8478 },
                    'Uruguay': { lat: -32.5228, lng: -55.7658 },
                    'Uzbekistan': { lat: 41.3775, lng: 64.5853 },
                    'Venezuela': { lat: 6.4238, lng: -66.5897 },                    'Yemen': { lat: 15.5527, lng: 48.5164 },
                    'Zambia': { lat: -13.1339, lng: 27.8493 },
                    'Zimbabwe': { lat: -19.0154, lng: 29.1549 },
                    // More comprehensive coverage for potential Excel variations
                    'Bahamas': { lat: 25.0343, lng: -77.3963 },
                    'Barbados': { lat: 13.1939, lng: -59.5432 },
                    'Belize': { lat: 17.1899, lng: -88.4976 },
                    'Bhutan': { lat: 27.5142, lng: 90.4336 },
                    'Brunei': { lat: 4.5353, lng: 114.7277 },
                    'Burundi': { lat: -3.3731, lng: 29.9189 },
                    'Cape Verde': { lat: 16.5388, lng: -24.0132 },
                    'Comoros': { lat: -11.6455, lng: 43.3333 },
                    'Congo': { lat: -0.2280, lng: 15.8277 },
                    'Democratic Republic of the Congo': { lat: -4.0383, lng: 21.7587 },
                    'Djibouti': { lat: 11.8251, lng: 42.5903 },
                    'Dominica': { lat: 15.3000, lng: -61.3833 },
                    'East Timor': { lat: -8.8742, lng: 125.7275 },
                    'Equatorial Guinea': { lat: 1.6508, lng: 10.2679 },
                    'Eritrea': { lat: 15.1794, lng: 39.7823 },
                    'Eswatini': { lat: -26.5225, lng: 31.4659 },
                    'Grenada': { lat: 12.1165, lng: -61.6790 },
                    'Guinea-Bissau': { lat: 11.8037, lng: -15.1804 },
                    'Guyana': { lat: 4.8604, lng: -58.9302 },
                    'Jordan': { lat: 30.5852, lng: 36.2384 },
                    'Kiribati': { lat: -3.3704, lng: -168.7340 },
                    'Lesotho': { lat: -29.6100, lng: 28.2336 },
                    'Liberia': { lat: 6.4281, lng: -9.4295 },
                    'Liechtenstein': { lat: 47.1660, lng: 9.5554 },
                    'Maldives': { lat: 3.2028, lng: 73.2207 },
                    'Marshall Islands': { lat: 7.1315, lng: 171.1845 },
                    'Mauritius': { lat: -20.3484, lng: 57.5522 },
                    'Micronesia': { lat: 7.4256, lng: 150.5508 },
                    'Monaco': { lat: 43.7384, lng: 7.4246 },
                    'Andorra': { lat: 42.5063, lng: 1.5218 },
                    'San Marino': { lat: 43.9424, lng: 12.4578 },
                    'Liechtenstein': { lat: 47.1660, lng: 9.5554 },
                    'Vatican City': { lat: 41.9029, lng: 12.4534 },
                    'Vatikan': { lat: 41.9029, lng: 12.4534 }, // Vatican in German
                    'Vatikanstadt': { lat: 41.9029, lng: 12.4534 }, // Vatican City in German
                    'Nauru': { lat: -0.5228, lng: 166.9315 },
                    'Palau': { lat: 7.5149, lng: 134.5825 },
                    'Saint Kitts and Nevis': { lat: 17.3578, lng: -62.7830 },
                    'Saint Lucia': { lat: 13.9094, lng: -60.9789 },
                    'Saint Vincent and the Grenadines': { lat: 12.9843, lng: -61.2872 },
                    'Samoa': { lat: -13.7590, lng: -172.1046 },
                    'San Marino': { lat: 43.9424, lng: 12.4578 },
                    'Sao Tome and Principe': { lat: 0.1864, lng: 6.6131 },
                    'Seychelles': { lat: -4.6796, lng: 55.4920 },
                    'Seychellen': { lat: -4.6796, lng: 55.4920 }, // Seychelles in German
                    'Sierra Leone': { lat: 8.4606, lng: -11.7799 },
                    'Solomon Islands': { lat: -9.6457, lng: 160.1562 },
                    'South Sudan': { lat: 6.8770, lng: 31.3070 },
                    'Tonga': { lat: -21.1789, lng: -175.1982 },
                    'Tuvalu': { lat: -7.1095, lng: 177.6493 },
                    'Vanuatu': { lat: -15.3767, lng: 166.9592 },
                    'Vatican City': { lat: 41.9029, lng: 12.4534 },
                    // German variations
                    'Vereinigte Staaten': { lat: 37.0902, lng: -95.7129 },
                    'Vereinigte Arabische Emirate': { lat: 23.4241, lng: 53.8478 },
                    'S√ºdafrika': { lat: -30.5595, lng: 22.9375 },
                    'Nordkorea': { lat: 40.3399, lng: 127.5101 },
                    'Elfenbeink√ºste': { lat: 7.5400, lng: -5.5471 },
                    'C√¥te d\'Ivoire': { lat: 7.5400, lng: -5.5471 },
                    'Ivory Coast': { lat: 7.5400, lng: -5.5471 },
                    // Additional English/German variations  
                    'North Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'Nordmazedonien': { lat: 41.6086, lng: 21.7453 },
                    'Bosnia-Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnien-Herzegowina': { lat: 43.9159, lng: 17.6791 },
                    'Central African Rep.': { lat: 6.6111, lng: 20.9394 },
                    'Zentralafrikanische Republik': { lat: 6.6111, lng: 20.9394 },                    'Democratic Rep. of Congo': { lat: -4.0383, lng: 21.7587 },
                    'Demokratische Republik Kongo': { lat: -4.0383, lng: 21.7587 },
                    'Kongo': { lat: -0.2280, lng: 15.8277 },
                    'Republic of the Congo': { lat: -0.2280, lng: 15.8277 },
                    // Additional missing countries with German variations
                    'Libyen': { lat: 26.3351, lng: 17.2283 }, // Libya in German
                    'Mongolei': { lat: 46.8625, lng: 103.8467 }, // Mongolia in German
                    'Malawi': { lat: -13.2543, lng: 34.3015 }, // Missing African country
                    'Mosambik': { lat: -18.6657, lng: 35.5296 }, // Mozambique in German
                    'Mozambique': { lat: -18.6657, lng: 35.5296 },
                    'Mauretanien': { lat: 21.0079, lng: -10.9408 }, // Mauritania in German
                    'Mauritania': { lat: 21.0079, lng: -10.9408 },
                    'Cabo Verde': { lat: 16.5388, lng: -24.0132 },
                    'Cape Verde': { lat: 16.5388, lng: -24.0132 },
                    'Kap Verde': { lat: 16.5388, lng: -24.0132 },
                    'S√£o Tom√© and Pr√≠ncipe': { lat: 0.1864, lng: 6.6131 },
                    'Sao Tome and Principe': { lat: 0.1864, lng: 6.6131 },
                    'S√£o Tom√© und Pr√≠ncipe': { lat: 0.1864, lng: 6.6131 },
                    'Timor-Leste': { lat: -8.8742, lng: 125.7275 },
                    'East Timor': { lat: -8.8742, lng: 125.7275 },
                    'Osttimor': { lat: -8.8742, lng: 125.7275 },
                    'Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'FYROM': { lat: 41.6086, lng: 21.7453 },
                    'Former Yugoslav Republic of Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'Swaziland': { lat: -26.5225, lng: 31.4659 }, // Old name for Eswatini
                    'Burma': { lat: 21.9162, lng: 95.9560 }, // Old name for Myanmar
                    'Myanmar (Burma)': { lat: 21.9162, lng: 95.9560 },
                    'DR Congo': { lat: -4.0383, lng: 21.7587 },
                    'DRC': { lat: -4.0383, lng: 21.7587 },
                    'Congo (Kinshasa)': { lat: -4.0383, lng: 21.7587 },
                    'Congo (Brazzaville)': { lat: -4.2634, lng: 15.2429 },
                    'Czech Republic': { lat: 49.8175, lng: 15.4730 },
                    'Czechia': { lat: 49.8175, lng: 15.4730 },
                    'Tschechien': { lat: 49.8175, lng: 15.4730 },
                    'Slovakia': { lat: 48.6690, lng: 19.6990 },
                    'Slovak Republic': { lat: 48.6690, lng: 19.6990 },
                    'Slowakei': { lat: 48.6690, lng: 19.6990 },
                    'United States of America': { lat: 37.0902, lng: -95.7129 },
                    'USA': { lat: 37.0902, lng: -95.7129 },
                    'US': { lat: 37.0902, lng: -95.7129 },
                    'United Kingdom': { lat: 55.3781, lng: -3.4360 },
                    'UK': { lat: 55.3781, lng: -3.4360 },
                    'Britain': { lat: 55.3781, lng: -3.4360 },
                    'Great Britain': { lat: 55.3781, lng: -3.4360 },
                    'Kamerun': { lat: 7.3697, lng: 12.3547 }, // Cameroon in German
                    'Cameroon': { lat: 7.3697, lng: 12.3547 },
                    'Tschad': { lat: 15.4542, lng: 18.7322 }, // Chad in German
                    'Chad': { lat: 15.4542, lng: 18.7322 },
                    'Gabun': { lat: -0.8037, lng: 11.6094 }, // Gabon in German
                    'Gabon': { lat: -0.8037, lng: 11.6094 },
                    '√Ñquatorialguinea': { lat: 1.6508, lng: 10.2679 }, // Equatorial Guinea in German
                    'Equatorial Guinea': { lat: 1.6508, lng: 10.2679 },
                    'Zentralafrikanische Republik': { lat: 6.6111, lng: 20.9394 }, // Central African Republic in German
                    'Central African Republic': { lat: 6.6111, lng: 20.9394 },
                    'Elfenbeink√ºste': { lat: 7.5400, lng: -5.5471 }, // Ivory Coast in German
                    'C√¥te d\'Ivoire': { lat: 7.5400, lng: -5.5471 },
                    'Ivory Coast': { lat: 7.5400, lng: -5.5471 },
                    'Burkina Faso': { lat: 12.2383, lng: -1.5616 },
                    'Ghana': { lat: 7.9465, lng: -1.0232 },
                    'Guinea': { lat: 9.9456, lng: -9.6966 },
                    'Guinea-Bissau': { lat: 11.8037, lng: -15.1804 },
                    'Sierra Leone': { lat: 8.4606, lng: -11.7799 },
                    'Liberia': { lat: 6.4281, lng: -9.4295 },
                    'Benin': { lat: 9.3077, lng: 2.3158 },
                    'Togo': { lat: 8.6195, lng: 0.8248 },
                    'Niger': { lat: 17.6078, lng: 8.0817 },
                    'Mali': { lat: 17.5707, lng: -3.9962 },
                    'Senegal': { lat: 14.4974, lng: -14.4524 },
                    'Gambia': { lat: 13.4432, lng: -15.3101 },
                    'S√ºdsudan': { lat: 6.8770, lng: 31.3070 }, // South Sudan in German
                    'South Sudan': { lat: 6.8770, lng: 31.3070 },
                    '√Ñthiopien': { lat: 9.1450, lng: 40.4897 }, // Ethiopia in German
                    'Ethiopia': { lat: 9.1450, lng: 40.4897 },
                    'Eritrea': { lat: 15.1794, lng: 39.7823 },
                    'Dschibuti': { lat: 11.8251, lng: 42.5903 }, // Djibouti in German
                    'Djibouti': { lat: 11.8251, lng: 42.5903 },
                    'Somalia': { lat: 5.1521, lng: 46.1996 },
                    'Kenia': { lat: -0.0236, lng: 37.9062 }, // Kenya in German
                    'Kenya': { lat: -0.0236, lng: 37.9062 },
                    'Uganda': { lat: 1.3733, lng: 32.2903 },
                    'Ruanda': { lat: -1.9403, lng: 29.8739 }, // Rwanda in German
                    'Rwanda': { lat: -1.9403, lng: 29.8739 },
                    'Burundi': { lat: -3.3731, lng: 29.9189 },
                    'Tansania': { lat: -6.3690, lng: 34.8888 }, // Tanzania in German
                    'Tanzania': { lat: -6.3690, lng: 34.8888 },
                    'Sambia': { lat: -13.1339, lng: 27.8493 }, // Zambia in German
                    'Zambia': { lat: -13.1339, lng: 27.8493 },
                    'Simbabwe': { lat: -19.0154, lng: 29.1549 }, // Zimbabwe in German
                    'Zimbabwe': { lat: -19.0154, lng: 29.1549 },
                    'Botswana': { lat: -22.3285, lng: 24.6849 },
                    'Namibia': { lat: -22.9576, lng: 18.4904 },
                    'Angola': { lat: -11.2027, lng: 17.8739 },
                    'Lesotho': { lat: -29.6100, lng: 28.2336 },
                    'Eswatini': { lat: -26.5225, lng: 31.4659 },
                    'Swasiland': { lat: -26.5225, lng: 31.4659 }, // Former name                    'Madagaskar': { lat: -18.7669, lng: 46.8691 }, // Madagascar in German
                    'Madagascar': { lat: -18.7669, lng: 46.8691 },
                    // Additional country variations for international rankings
                    'Cabo Verde': { lat: 16.5388, lng: -24.0132 },
                    'Cape Verde': { lat: 16.5388, lng: -24.0132 },
                    'Kap Verde': { lat: 16.5388, lng: -24.0132 },
                    'S√£o Tom√© and Pr√≠ncipe': { lat: 0.1864, lng: 6.6131 },
                    'Sao Tome and Principe': { lat: 0.1864, lng: 6.6131 },
                    'S√£o Tom√© und Pr√≠ncipe': { lat: 0.1864, lng: 6.6131 },
                    'Timor-Leste': { lat: -8.8742, lng: 125.7275 },
                    'East Timor': { lat: -8.8742, lng: 125.7275 },
                    'Osttimor': { lat: -8.8742, lng: 125.7275 },
                    'Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'FYROM': { lat: 41.6086, lng: 21.7453 },
                    'Former Yugoslav Republic of Macedonia': { lat: 41.6086, lng: 21.7453 },
                    'Swaziland': { lat: -26.5225, lng: 31.4659 }, // Old name for Eswatini
                    'Burma': { lat: 21.9162, lng: 95.9560 }, // Old name for Myanmar
                    'Myanmar (Burma)': { lat: 21.9162, lng: 95.9560 },
                    'DR Congo': { lat: -4.0383, lng: 21.7587 },
                    'DRC': { lat: -4.0383, lng: 21.7587 },
                    'Congo (Kinshasa)': { lat: -4.0383, lng: 21.7587 },
                    'Congo (Brazzaville)': { lat: -4.2634, lng: 15.2429 },
                    'Czech Republic': { lat: 49.8175, lng: 15.4730 },
                    'Czechia': { lat: 49.8175, lng: 15.4730 },
                    'Tschechien': { lat: 49.8175, lng: 15.4730 },
                    'Slovakia': { lat: 48.6690, lng: 19.6990 },
                    'Slovak Republic': { lat: 48.6690, lng: 19.6990 },
                    'Slowakei': { lat: 48.6690, lng: 19.6990 },
                    'United States of America': { lat: 37.0902, lng: -95.7129 },
                    'USA': { lat: 37.0902, lng: -95.7129 },
                    'US': { lat: 37.0902, lng: -95.7129 },
                    'United Kingdom': { lat: 55.3781, lng: -3.4360 },
                    'UK': { lat: 55.3781, lng: -3.4360 },
                    'Britain': { lat: 55.3781, lng: -3.4360 },
                    'Great Britain': { lat: 55.3781, lng: -3.4360 },                    'Mauritania': { lat: 21.0079, lng: -10.9408 },
                    'Kasachstan': { lat: 48.0196, lng: 66.9237 }, // Kazakhstan in German
                    'Kazakhstan': { lat: 48.0196, lng: 66.9237 },
                    'Kazakstan': { lat: 48.0196, lng: 66.9237 }, // Alternative spelling                    'Bolivien': { lat: -16.2902, lng: -63.5887 }, // Bolivia in German
                    'Bolivia': { lat: -16.2902, lng: -63.5887 },
                    // Additional European countries and microstates
                    'Island': { lat: 64.9631, lng: -19.0208 }, // Iceland in German
                    'Iceland': { lat: 64.9631, lng: -19.0208 },
                    'Luxemburg': { lat: 49.8153, lng: 6.1296 }, // Luxembourg in German
                    'Luxembourg': { lat: 49.8153, lng: 6.1296 },
                    'Andorra': { lat: 42.5063, lng: 1.5218 },
                    'San Marino': { lat: 43.9424, lng: 12.4578 },
                    'Monaco': { lat: 43.7384, lng: 7.4246 },
                    'Liechtenstein': { lat: 47.1660, lng: 9.5554 },
                    'Vatikan': { lat: 41.9029, lng: 12.4534 }, // Vatican in German
                    'Vatican City': { lat: 41.9029, lng: 12.4534 },
                    'Vatikanstadt': { lat: 41.9029, lng: 12.4534 }, // Vatican City in German                    'Holy See': { lat: 41.9029, lng: 12.4534 }, // Alternative name for Vatican
                    'Heiliger Stuhl': { lat: 41.9029, lng: 12.4534 }, // Holy See in German
                    // Additional potentially missing countries
                    'Antigua and Barbuda': { lat: 17.0608, lng: -61.7964 },
                    'Antigua und Barbuda': { lat: 17.0608, lng: -61.7964 },
                    'Saint Kitts and Nevis': { lat: 17.3578, lng: -62.7830 },
                    'St. Kitts and Nevis': { lat: 17.3578, lng: -62.7830 },
                    'Saint Lucia': { lat: 13.9094, lng: -60.9789 },
                    'St. Lucia': { lat: 13.9094, lng: -60.9789 },
                    'Saint Vincent and the Grenadines': { lat: 12.9843, lng: -61.2872 },
                    'St. Vincent and the Grenadines': { lat: 12.9843, lng: -61.2872 },
                    'Trinidad and Tobago': { lat: 10.6918, lng: -61.2225 },
                    'Trinidad und Tobago': { lat: 10.6918, lng: -61.2225 },
                    'Federated States of Micronesia': { lat: 7.4256, lng: 150.5508 },
                    'Micronesia (Federated States of)': { lat: 7.4256, lng: 150.5508 },
                    'Marshall Islands': { lat: 7.1315, lng: 171.1845 },
                    'Marshallinseln': { lat: 7.1315, lng: 171.1845 },
                    'Papua New Guinea': { lat: -6.3140, lng: 143.9555 },
                    'Papua-Neuguinea': { lat: -6.3140, lng: 143.9555 },
                    'Solomon Islands': { lat: -9.6457, lng: 160.1562 },
                    'Salomonen': { lat: -9.6457, lng: 160.1562 },
                    'Kiribati': { lat: -3.3704, lng: -168.7340 },
                    'Tuvalu': { lat: -7.1095, lng: 177.6493 },
                    'Nauru': { lat: -0.5228, lng: 166.9315 },                    'Palau': { lat: 7.5149, lng: 134.5825 },
                    // Bosnia and Herzegovina variants
                    'Bosnia and Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnia & Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnia-Herzegovina': { lat: 43.9159, lng: 17.6791 },
                    'Bosnien und Herzegowina': { lat: 43.9159, lng: 17.6791 }, // German
                    'Bosnien-Herzegowina': { lat: 43.9159, lng: 17.6791 }, // German short
                    'Bosnia': { lat: 43.9159, lng: 17.6791 }, // Short form                    'Bosnien': { lat: 43.9159, lng: 17.6791 }, // German short
                    // Central Asian and Caucasus countries
                    'Armenien': { lat: 40.0691, lng: 45.0382 }, // Armenia in German
                    'Armenia': { lat: 40.0691, lng: 45.0382 },
                    'Aserbaidschan': { lat: 40.1431, lng: 47.5769 }, // Azerbaijan in German
                    'Azerbaijan': { lat: 40.1431, lng: 47.5769 },
                    'Kirgisistan': { lat: 41.2044, lng: 74.7661 }, // Kyrgyzstan in German
                    'Kirgistan': { lat: 41.2044, lng: 74.7661 }, // Alternative German spelling
                    'Kyrgyzstan': { lat: 41.2044, lng: 74.7661 },
                    'Tadschikistan': { lat: 38.8610, lng: 71.2761 }, // Tajikistan in German
                    'Tajikistan': { lat: 38.8610, lng: 71.2761 },
                    'Usbekistan': { lat: 41.3775, lng: 64.5853 }, // Uzbekistan in German
                    'Uzbekistan': { lat: 41.3775, lng: 64.5853 },
                    'Turkmenistan': { lat: 38.9697, lng: 59.5563 },                    'Georgien': { lat: 42.3154, lng: 43.3569 }, // Georgia in German
                    'Georgia': { lat: 42.3154, lng: 43.3569 },                    'Marokko': { lat: 31.7917, lng: -7.0926 }, // Morocco in German
                    'Morocco': { lat: 31.7917, lng: -7.0926 },
                    'Maroc': { lat: 31.7917, lng: -7.0926 }, // French name
                    'Kingdom of Morocco': { lat: 31.7917, lng: -7.0926 }, // Official name                    'K√∂nigreich Marokko': { lat: 31.7917, lng: -7.0926 }, // Official German name
                    'Jamaika': { lat: 18.1096, lng: -77.2975 }, // Jamaica in German
                    'Jamaica': { lat: 18.1096, lng: -77.2975 },
                    'Taiwan': { lat: 23.6978, lng: 120.9605 },
                    'Taiwan (Province of China)': { lat: 23.6978, lng: 120.9605 }, // UN designation
                    'Chinese Taipei': { lat: 23.6978, lng: 120.9605 }, // Olympic designation
                    'Republic of China': { lat: 23.6978, lng: 120.9605 }, // Official name                    'Republik China': { lat: 23.6978, lng: 120.9605 }, // German
                    // OECS and additional Caribbean states
                    'OECS': { lat: 14.0, lng: -61.0 }, // Organization of Eastern Caribbean States
                    'Organization of Eastern Caribbean States': { lat: 14.0, lng: -61.0 },
                    'Eastern Caribbean': { lat: 14.0, lng: -61.0 },
                    'Ostkaribik': { lat: 14.0, lng: -61.0 }, // German
                    'Antigua and Barbuda': { lat: 17.0608, lng: -61.7964 },
                    'Antigua und Barbuda': { lat: 17.0608, lng: -61.7964 }, // German
                    'Saint Lucia': { lat: 13.9094, lng: -60.9789 },
                    'St. Lucia': { lat: 13.9094, lng: -60.9789 },
                    'Saint Vincent and the Grenadines': { lat: 12.9843, lng: -61.2872 },
                    'St. Vincent and the Grenadines': { lat: 12.9843, lng: -61.2872 },
                    'St. Vincent und die Grenadinen': { lat: 12.9843, lng: -61.2872 }, // German
                    'Grenada': { lat: 12.1165, lng: -61.6790 },
                    'Dominica': { lat: 15.3000, lng: -61.3833 },
                    'Saint Kitts and Nevis': { lat: 17.3578, lng: -62.7830 },
                    'St. Kitts and Nevis': { lat: 17.3578, lng: -62.7830 },                    'St. Kitts und Nevis': { lat: 17.3578, lng: -62.7830 }, // German
                    // Additional missing countries - second set
                    'Republik Kongo': { lat: -0.2280, lng: 15.8277 }, // Republic of Congo in German
                    'Republic of Congo': { lat: -0.2280, lng: 15.8277 },
                    'Congo Republic': { lat: -0.2280, lng: 15.8277 },
                    'Congo-Brazzaville': { lat: -0.2280, lng: 15.8277 },
                    'Komoren': { lat: -11.6455, lng: 43.3333 }, // Comoros in German
                    'Comoros': { lat: -11.6455, lng: 43.3333 },
                    'Zypern': { lat: 35.1264, lng: 33.4299 }, // Cyprus in German
                    'Cyprus': { lat: 35.1264, lng: 33.4299 },
                    'Nordzypern': { lat: 35.2833, lng: 33.3833 }, // Northern Cyprus in German
                    'Northern Cyprus': { lat: 35.2833, lng: 33.3833 },
                    'Turkish Republic of Northern Cyprus': { lat: 35.2833, lng: 33.3833 },
                    'Katar': { lat: 25.3548, lng: 51.1839 }, // Qatar in German
                    'Qatar': { lat: 25.3548, lng: 51.1839 },
                    'Albanien': { lat: 41.1533, lng: 20.1683 }, // Albania in German
                    'Albania': { lat: 41.1533, lng: 20.1683 },
                    'Kosovo': { lat: 42.6026, lng: 20.9030 },
                    'Malediven': { lat: 3.2028, lng: 73.2207 }, // Maldives in German
                    'Maldives': { lat: 3.2028, lng: 73.2207 },
                    'Kolumbien': { lat: 4.5709, lng: -74.2973 }, // Colombia in German
                    'Colombia': { lat: 4.5709, lng: -74.2973 },
                    'Singapur': { lat: 1.3521, lng: 103.8198 }, // Singapore in German
                    'Singapore': { lat: 1.3521, lng: 103.8198 },
                    'Salvador': { lat: 13.7942, lng: -88.8965 },
                    'El Salvador': { lat: 13.7942, lng: -88.8965 },
                    'Hongkong': { lat: 22.3193, lng: 114.1694 }, // Hong Kong in German
                    'Hong Kong': { lat: 22.3193, lng: 114.1694 },
                    'Hong Kong SAR': { lat: 22.3193, lng: 114.1694 },
                    'Bangladesch': { lat: 23.685, lng: 90.3563 }, // Bangladesh in German
                    'Bangladesh': { lat: 23.685, lng: 90.3563 },
                    'Jemen': { lat: 15.5527, lng: 48.5164 }, // Yemen in German
                    'Yemen': { lat: 15.5527, lng: 48.5164 },
                    'Kambodscha': { lat: 12.5657, lng: 104.9910 }, // Cambodia in German
                    'Cambodia': { lat: 12.5657, lng: 104.9910 },
                    'Pal√§stina': { lat: 31.9522, lng: 35.2332 }, // Palestine in German
                    'Palestine': { lat: 31.9522, lng: 35.2332 },
                    'Palestinian Territories': { lat: 31.9522, lng: 35.2332 },
                    'Pal√§stinensische Gebiete': { lat: 31.9522, lng: 35.2332 }, // German
                    'State of Palestine': { lat: 31.9522, lng: 35.2332 },
                    'Kuba': { lat: 21.5218, lng: -77.7812 }, // Cuba in German
                    'Cuba': { lat: 21.5218, lng: -77.7812 }
                };
                  // Convert Excel data to our format
                countries = jsonData.map((row, index) => {
                    // Debug: Log first few rows to see what data we have
                    if (index < 3) {
                        console.log('üîç Raw row data:', row);
                    }
                      // Try different possible column names for score
                    const scoreValue = row['Punktzahl 2025'] ||  // Correct column name from Excel
                        row['Punktezahl 2025'] || 
                        row['Score 2025'] || 
                        row['Points 2025'] || 
                        row['Punkte'] ||
                        row['Score'] ||
                        row['Wert'] ||
                        row['Lage 2025'] ||  // RSF uses "Lage" for score
                        row['Situation 2025'] ||
                        row['Index'] ||
                        row['Value'] ||
                        0;
                    
                    // Handle both numeric and string values
                    const score = typeof scoreValue === 'number' ? scoreValue : parseFloat(scoreValue) || 0;
                    
                    // Try different possible column names for rank
                    const rank = parseInt(
                        row['Rang 2025'] || 
                        row['Rank 2025'] || 
                        row['Position 2025'] || 
                        row['Rang'] ||
                        row['Rank'] ||
                        row['Position'] ||
                        (index + 1) // fallback to sequential numbering
                    );
                    
                    // Try different possible column names for country name
                    const countryName = (
                        row['Land'] || 
                        row['Country'] || 
                        row['Name'] || 
                        row['Staat'] ||
                        row['Land/Territorium'] ||
                        row['Territory'] ||
                        ''
                    ).toString().trim();
                    
                    // Get coordinates from Excel or fallback
                    let lat = parseFloat(row['Latitude'] || row['Lat'] || row['Breitengrad'] || 0);
                    let lng = parseFloat(row['Longitude'] || row['Lng'] || row['Long'] || row['L√§ngengrad'] || 0);
                    
                    // If no coordinates in Excel, use fallback
                    if ((!lat || !lng) && countryCoordinates[countryName]) {
                        lat = countryCoordinates[countryName].lat;
                        lng = countryCoordinates[countryName].lng;
                    }
                    
                    // Debug: Log conversion for first few countries
                    if (index < 3) {
                        console.log(`üîç Country ${index + 1}: ${countryName}, Score: ${score}, Rank: ${rank}`);
                    }
                    
                    // Determine color based on rank OR score if rank is not available
                    let color = '#8b0000'; // Default dark red
                    const rankToUse = rank || (index + 1);
                    if (rankToUse <= 20) color = '#27ae60'; // Green
                    else if (rankToUse <= 40) color = '#2ecc71'; // Light green
                    else if (rankToUse <= 60) color = '#f39c12'; // Orange
                    else if (rankToUse <= 80) color = '#e67e22'; // Dark orange
                    else if (rankToUse <= 100) color = '#c0392b'; // Red
                      return {
                        name: countryName,
                        lat: lat,
                        lng: lng,
                        score: score || 0, // Ensure score is at least 0
                        rank: rank || (index + 1), // Use index as fallback rank
                        color: color
                    };
                }).filter(country => country.name); // Only require name
                  console.log('‚úÖ Loaded', countries.length, 'countries from Excel file');
                console.log('üåç Sample countries:', countries.slice(0, 5));
                console.log('üó∫Ô∏è Countries with coordinates:', countries.filter(c => c.lat && c.lng).length);
                console.log('üìç Countries without coordinates:', countries.filter(c => !c.lat || !c.lng).length);
                console.log('üìä Countries with scores > 0:', countries.filter(c => c.score > 0).length);
                console.log('üèÜ Countries with valid ranks:', countries.filter(c => c.rank > 0).length);
                
                // List all countries without coordinates
                const countriesWithoutCoords = countries.filter(c => !c.lat || !c.lng || c.lat === 0 || c.lng === 0);
                if (countriesWithoutCoords.length > 0) {
                    console.log('‚ö†Ô∏è COUNTRIES WITHOUT COORDINATES:');
                    countriesWithoutCoords.forEach(c => console.log(`   - ${c.name} (Rank: ${c.rank}, Score: ${c.score})`));
                }
                
                // List all country names from Excel for debugging
                console.log('üìã ALL COUNTRIES FROM EXCEL:');
                countries.forEach((c, i) => {
                    if (i < 20) console.log(`   ${i+1}. ${c.name} (${c.lat ? 'HAS' : 'NO'} coordinates)`);
                });
                
                // Initialize the map after data is loaded
                initializeMap();
                
            } catch (error) {
                console.error('‚ùå Error loading Excel file:', error);
                console.log('üîÑ Using minimal fallback data...');
                  // Minimal fallback data for testing
                countries = [
                    { name: 'Norwegen', lat: 60.472, lng: 8.4689, score: 7.82, color: '#27ae60', rank: 1 },
                    { name: 'Deutschland', lat: 51.1657, lng: 10.4515, score: 15.24, color: '#27ae60', rank: 10 },
                    { name: 'USA', lat: 37.0902, lng: -95.7129, score: 40.85, color: '#f39c12', rank: 50 },
                    { name: 'China', lat: 35.8617, lng: 104.1954, score: 78.30, color: '#e74c3c', rank: 170 },
                    { name: 'Russland', lat: 61.5240, lng: 105.3188, score: 83.42, color: '#8b0000', rank: 175 }
                ];
                
                console.log('üìç Using fallback data with', countries.length, 'countries');
                initializeMap();
            }
        }// Initialize map function
        function initializeMap() {
            if (pressMap) {
                pressMap.remove(); // Remove existing map if any
            }
            
            // Call the original map creation and ranking functions
            setTimeout(() => {
                createPressMap();
                populateModalRanking();
            }, 100);        }

        // Modal √∂ffnen/schlie√üen
        window.openModal = function(modalId) {
            const modal = document.getElementById('modal-' + modalId);
            if (modal) {
                modal.classList.add('active');
                if (modalId === 'worldmap') {
                    setTimeout(() => {
                        createPressMap();
                        populateModalRanking();
                    }, 200);
                }
            }
        };

        // 3-minute inactivity timeout
        let inactivityTimer = null;
        function resetInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                window.location.href = 'index.html';
            }, 180000); // 3 minutes
        }

        // Track user activity
        ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'].forEach(event => {
            document.addEventListener(event, resetInactivityTimer, { passive: true });
        });

        // Start timer
        resetInactivityTimer();

        // Disable right-click context menu
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });

        // Disable F12 and developer tools shortcuts
        document.addEventListener('keydown', (e) => {
            // F12, Ctrl+Shift+I, Ctrl+Shift+C, Ctrl+U
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'C')) ||
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                return false;
            }
        });

        // Zur√ºck zur Hauptseite
        window.goBackToMain = function() {
            window.location.href = 'index.html';
        };

        window.closeModal = function(modalId) {
            // Nicht mehr verwendet, aber f√ºr Kompatibilit√§t beibehalten
        };

        // Pressefreiheits-Karte erstellen
        function createPressMap() {
            try {
                const mapContainer = document.getElementById('pressmap');
                if (!mapContainer) return;

                // Initialisiere die Karte
                pressMap = L.map('pressmap').setView([30, 0], 2);

                // Basiskarte hinzuf√ºgen (OpenStreetMap)
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 10,
                    minZoom: 1
                }).addTo(pressMap);                // L√§nder als Marker auf der Karte hinzuf√ºgen
                countries.forEach((country, index) => {
                    let lat = country.lat;
                    let lng = country.lng;
                    
                    // Skip countries without coordinates rather than placing them in a grid
                    if (!lat || !lng || lat === 0 || lng === 0) {
                        console.warn(`‚ö†Ô∏è No coordinates found for ${country.name}, skipping map marker`);
                        return; // Skip this country for map display
                    }
                    
                    const marker = L.circleMarker([lat, lng], {
                        radius: 8,
                        fillColor: country.color,
                        color: '#ffffff',
                        weight: 2,
                        opacity: 1,
                        fillOpacity: 0.8
                    }).addTo(pressMap);// Popup-Inhalt
                        const popupContent = 
                            '<div style="max-width: 280px;">' +
                            '<h3 style="margin: 0 0 10px 0; color: #2c3e50; font-size: 1.2rem;">' + country.name + '</h3>' +
                            '<div style="background: linear-gradient(135deg, ' + country.color + ', ' + country.color + '90); color: white; padding: 8px 12px; border-radius: 15px; text-align: center; margin-bottom: 15px;">' +
                            '<strong>Pressefreiheits-Score: ' + country.score.toFixed(2) + '</strong>' +
                            '</div>' +
                            '<div style="margin-bottom: 10px; text-align: center;">' +
                            '<p style="color: #666; font-size: 0.9rem; margin: 0;">Rang: <strong>' + country.rank + '</strong> von 180 L√§ndern</p>' +
                            '</div>' +
                            '</div>';

                        marker.bindPopup(popupContent);

                        // Add click event to highlight country in ranking table
                        marker.on('click', function() {
                            highlightCountryInTable(country.name);
                        });                });

                console.log('‚úÖ Pressefreiheits-Karte erfolgreich erstellt');
            } catch (error) {
                console.error('‚ùå Fehler beim Erstellen der Karte:', error);
            }
        }// Rangliste im Modal f√ºllen
        function populateModalRanking() {
            const tbody = document.getElementById('ranking-tbody-modal');
            if (!tbody) return;

            tbody.innerHTML = '';
            
            const sortedCountries = [...countries].sort((a, b) => a.rank - b.rank);
            
            console.log('üìã Populating ranking table with', sortedCountries.length, 'countries');
            
            sortedCountries.forEach((country, index) => {
                if (!country.rank && !country.name) return;
                
                const rank = country.rank || (index + 1);
                const score = country.score || 0;
                  // Debug: Log first few entries
                if (index < 5) {
                    console.log(`üìä Table entry ${index + 1}: ${country.name}, Rank: ${rank}, Score: ${score}`);
                }
                  // Score color logic: HIGH scores = GOOD (green), LOW scores = BAD (red)
                // Based on RSF 2025 data where Norway has ~92 points (best)
                let scoreColor = '#e74c3c'; // Default: Rot f√ºr niedrige Scores (schlecht)
                if (score >= 80) scoreColor = '#27ae60'; // Gr√ºn f√ºr hohe Scores (sehr gut)
                else if (score >= 70) scoreColor = '#2ecc71'; // Hellgr√ºn f√ºr gute Scores
                else if (score >= 50) scoreColor = '#f39c12'; // Orange f√ºr mittlere Scores
                else if (score >= 30) scoreColor = '#e67e22'; // Dunkelorange f√ºr niedrige Scores
                  const row = document.createElement('tr');
                row.style.borderBottom = '1px solid #f0f0f0';
                row.style.cursor = 'pointer';
                row.style.transition = 'background-color 0.3s ease';
                row.setAttribute('data-country', country.name);
                
                // Add hover effects
                row.addEventListener('mouseenter', function() {
                    this.style.backgroundColor = '#f8f9fa';
                });
                row.addEventListener('mouseleave', function() {
                    if (!this.classList.contains('highlighted')) {
                        this.style.backgroundColor = '';
                    }
                });
                
                // Add click event to zoom to country on map
                row.addEventListener('click', function() {
                    zoomToCountryOnMap(country.name, country.lat, country.lng);
                });
                
                // Format score to show decimal places
                const formattedScore = score > 0 ? score.toFixed(2) : 'N/A';
                
                row.innerHTML = `
                    <td style="padding: 8px; text-align: center; font-weight: ${rank <= 10 ? 'bold' : 'normal'}; color: ${rank <= 10 ? '#2c3e50' : '#666'};">${rank}</td>
                    <td style="padding: 8px; font-weight: ${['Deutschland', 'USA', 'China', 'Russland'].includes(country.name) ? 'bold' : 'normal'};">${country.name}</td>
                    <td style="padding: 8px; text-align: center; color: ${scoreColor}; font-weight: bold;">${formattedScore}</td>
                `;
                
                tbody.appendChild(row);
            });
            
            console.log('‚úÖ Ranking table populated successfully');
        }        // Initialisiere beim Laden der Seite
        document.addEventListener('DOMContentLoaded', () => {
            // Load RSF data from Excel file first, then initialize map
            loadRSFData();
        });

        // Function to highlight country in ranking table
        function highlightCountryInTable(countryName) {
            // Remove previous highlights
            const previousHighlighted = document.querySelectorAll('tr.highlighted');
            previousHighlighted.forEach(row => {
                row.classList.remove('highlighted');
                row.style.backgroundColor = '';
            });
            
            // Find and highlight the country row
            const rows = document.querySelectorAll('tr[data-country]');
            rows.forEach(row => {
                if (row.getAttribute('data-country') === countryName) {
                    row.classList.add('highlighted');
                    row.style.backgroundColor = '#e3f2fd';
                    row.style.fontWeight = 'bold';
                    
                    // Scroll to the row
                    row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // Flash effect
                    row.style.animation = 'flash 1s ease-in-out';
                    setTimeout(() => {
                        row.style.animation = '';
                    }, 1000);
                }
            });
        }        // Function to get regional zoom settings for a country
        function getRegionalZoom(countryName, lat, lng) {
            // Define regions with their center coordinates and zoom levels
            const regions = {
                // Skandinavien
                'Norway': { center: [62, 15], zoom: 4 },
                'Norwegen': { center: [62, 15], zoom: 4 },
                'Sweden': { center: [62, 15], zoom: 4 },
                'Schweden': { center: [62, 15], zoom: 4 },
                'Denmark': { center: [62, 15], zoom: 4 },
                'D√§nemark': { center: [62, 15], zoom: 4 },
                'Finland': { center: [62, 15], zoom: 4 },
                'Finnland': { center: [62, 15], zoom: 4 },
                'Iceland': { center: [62, 15], zoom: 4 },
                'Island': { center: [62, 15], zoom: 4 },
                
                // Mitteleuropa
                'Germany': { center: [51, 10], zoom: 4 },
                'Deutschland': { center: [51, 10], zoom: 4 },
                'Austria': { center: [51, 10], zoom: 4 },
                '√ñsterreich': { center: [51, 10], zoom: 4 },
                'Switzerland': { center: [51, 10], zoom: 4 },
                'Schweiz': { center: [51, 10], zoom: 4 },
                'Czech Republic': { center: [51, 10], zoom: 4 },
                'Tschechien': { center: [51, 10], zoom: 4 },
                'Poland': { center: [51, 10], zoom: 4 },
                'Polen': { center: [51, 10], zoom: 4 },
                'Slovakia': { center: [51, 10], zoom: 4 },
                'Slowakei': { center: [51, 10], zoom: 4 },
                'Hungary': { center: [51, 10], zoom: 4 },
                'Ungarn': { center: [51, 10], zoom: 4 },
                
                // Westeuropa
                'France': { center: [47, 2], zoom: 4 },
                'Frankreich': { center: [47, 2], zoom: 4 },
                'Belgium': { center: [47, 2], zoom: 4 },
                'Belgien': { center: [47, 2], zoom: 4 },
                'Netherlands': { center: [47, 2], zoom: 4 },
                'Niederlande': { center: [47, 2], zoom: 4 },
                'Luxembourg': { center: [47, 2], zoom: 4 },
                'Luxemburg': { center: [47, 2], zoom: 4 },
                
                // Britische Inseln
                'United Kingdom': { center: [54, -2], zoom: 4 },
                'UK': { center: [54, -2], zoom: 4 },
                'Ireland': { center: [54, -2], zoom: 4 },
                'Irland': { center: [54, -2], zoom: 4 },
                
                // S√ºdeuropa
                'Spain': { center: [40, 0], zoom: 4 },
                'Spanien': { center: [40, 0], zoom: 4 },
                'Portugal': { center: [40, 0], zoom: 4 },
                'Italy': { center: [40, 0], zoom: 4 },
                'Italien': { center: [40, 0], zoom: 4 },
                'Greece': { center: [40, 0], zoom: 4 },
                'Griechenland': { center: [40, 0], zoom: 4 },
                'Malta': { center: [40, 0], zoom: 4 },
                
                // Balkan
                'Serbia': { center: [44, 20], zoom: 4 },
                'Serbien': { center: [44, 20], zoom: 4 },
                'Croatia': { center: [44, 20], zoom: 4 },
                'Kroatien': { center: [44, 20], zoom: 4 },
                'Bosnia and Herzegovina': { center: [44, 20], zoom: 4 },
                'Bosnien': { center: [44, 20], zoom: 4 },
                'Slovenia': { center: [44, 20], zoom: 4 },
                'Slowenien': { center: [44, 20], zoom: 4 },
                'North Macedonia': { center: [44, 20], zoom: 4 },
                'Albania': { center: [44, 20], zoom: 4 },
                'Albanien': { center: [44, 20], zoom: 4 },
                'Montenegro': { center: [44, 20], zoom: 4 },
                'Kosovo': { center: [44, 20], zoom: 4 },
                
                // Osteuropa
                'Russia': { center: [60, 60], zoom: 3 },
                'Russland': { center: [60, 60], zoom: 3 },
                'Ukraine': { center: [50, 30], zoom: 4 },
                'Belarus': { center: [50, 30], zoom: 4 },
                'Wei√ürussland': { center: [50, 30], zoom: 4 },
                'Moldova': { center: [50, 30], zoom: 4 },
                'Moldau': { center: [50, 30], zoom: 4 },
                'Romania': { center: [50, 30], zoom: 4 },
                'Rum√§nien': { center: [50, 30], zoom: 4 },
                'Bulgaria': { center: [50, 30], zoom: 4 },
                'Bulgarien': { center: [50, 30], zoom: 4 },
                
                // Baltikum
                'Estonia': { center: [58, 25], zoom: 4 },
                'Estland': { center: [58, 25], zoom: 4 },
                'Latvia': { center: [58, 25], zoom: 4 },
                'Lettland': { center: [58, 25], zoom: 4 },
                'Lithuania': { center: [58, 25], zoom: 4 },
                'Litauen': { center: [58, 25], zoom: 4 },
                
                // Nordamerika
                'United States': { center: [39, -98], zoom: 3 },
                'USA': { center: [39, -98], zoom: 3 },
                'Canada': { center: [56, -106], zoom: 3 },
                'Kanada': { center: [56, -106], zoom: 3 },
                'Mexico': { center: [23, -102], zoom: 4 },
                'Mexiko': { center: [23, -102], zoom: 4 },
                
                // S√ºdamerika
                'Brazil': { center: [-10, -55], zoom: 3 },
                'Brasilien': { center: [-10, -55], zoom: 3 },
                'Argentina': { center: [-34, -64], zoom: 3 },
                'Argentinien': { center: [-34, -64], zoom: 3 },
                'Chile': { center: [-30, -71], zoom: 3 },
                'Colombia': { center: [4, -72], zoom: 4 },
                'Kolumbien': { center: [4, -72], zoom: 4 },
                'Peru': { center: [-9, -75], zoom: 4 },
                'Venezuela': { center: [6, -66], zoom: 4 },
                'Ecuador': { center: [-1, -78], zoom: 4 },
                'Uruguay': { center: [-33, -56], zoom: 5 },
                'Paraguay': { center: [-23, -58], zoom: 5 },
                'Bolivia': { center: [-17, -65], zoom: 4 },
                'Bolivien': { center: [-17, -65], zoom: 4 },
                
                // Ostasien
                'China': { center: [35, 104], zoom: 3 },
                'Japan': { center: [36, 138], zoom: 4 },
                'South Korea': { center: [36, 128], zoom: 5 },
                'S√ºdkorea': { center: [36, 128], zoom: 5 },
                'North Korea': { center: [40, 127], zoom: 5 },
                'Nordkorea': { center: [40, 127], zoom: 5 },
                'Taiwan': { center: [24, 121], zoom: 6 },
                'Hong Kong': { center: [22, 114], zoom: 6 },
                'Hongkong': { center: [22, 114], zoom: 6 },
                
                // S√ºdasien
                'India': { center: [20, 77], zoom: 3 },
                'Indien': { center: [20, 77], zoom: 3 },
                'Pakistan': { center: [30, 70], zoom: 4 },
                'Bangladesh': { center: [24, 90], zoom: 5 },
                'Bangladesch': { center: [24, 90], zoom: 5 },
                'Sri Lanka': { center: [7, 81], zoom: 6 },
                'Nepal': { center: [28, 84], zoom: 5 },
                'Bhutan': { center: [27, 90], zoom: 6 },
                
                // S√ºdostasien
                'Indonesia': { center: [-2, 118], zoom: 3 },
                'Indonesien': { center: [-2, 118], zoom: 3 },
                'Thailand': { center: [15, 100], zoom: 4 },
                'Vietnam': { center: [14, 108], zoom: 4 },
                'Malaysia': { center: [4, 109], zoom: 4 },
                'Philippines': { center: [13, 122], zoom: 4 },
                'Philippinen': { center: [13, 122], zoom: 4 },
                'Singapore': { center: [1, 103], zoom: 6 },
                'Singapur': { center: [1, 103], zoom: 6 },
                'Cambodia': { center: [13, 105], zoom: 5 },
                'Kambodscha': { center: [13, 105], zoom: 5 },
                'Laos': { center: [18, 105], zoom: 5 },
                'Myanmar': { center: [22, 98], zoom: 4 },
                'Burma': { center: [22, 98], zoom: 4 },
                
                // Naher Osten
                'Turkey': { center: [39, 35], zoom: 4 },
                'T√ºrkei': { center: [39, 35], zoom: 4 },
                'Iran': { center: [32, 53], zoom: 4 },
                'Iraq': { center: [33, 44], zoom: 4 },
                'Irak': { center: [33, 44], zoom: 4 },
                'Syria': { center: [35, 38], zoom: 5 },
                'Syrien': { center: [35, 38], zoom: 5 },
                'Lebanon': { center: [34, 36], zoom: 6 },
                'Libanon': { center: [34, 36], zoom: 6 },
                'Jordan': { center: [31, 36], zoom: 5 },
                'Jordanien': { center: [31, 36], zoom: 5 },
                'Israel': { center: [31, 35], zoom: 5 },
                'Palestine': { center: [32, 35], zoom: 6 },
                'Pal√§stina': { center: [32, 35], zoom: 6 },
                'Saudi Arabia': { center: [24, 45], zoom: 4 },
                'Saudi-Arabien': { center: [24, 45], zoom: 4 },
                'UAE': { center: [24, 54], zoom: 5 },
                'Qatar': { center: [25, 51], zoom: 6 },
                'Katar': { center: [25, 51], zoom: 6 },
                'Kuwait': { center: [29, 48], zoom: 6 },
                'Bahrain': { center: [26, 50], zoom: 7 },
                'Oman': { center: [21, 56], zoom: 5 },
                'Yemen': { center: [15, 48], zoom: 5 },
                'Jemen': { center: [15, 48], zoom: 5 },
                
                // Afrika
                'Egypt': { center: [26, 30], zoom: 4 },
                '√Ñgypten': { center: [26, 30], zoom: 4 },
                'Libya': { center: [25, 17], zoom: 4 },
                'Libyen': { center: [25, 17], zoom: 4 },
                'Tunisia': { center: [34, 9], zoom: 5 },
                'Tunesien': { center: [34, 9], zoom: 5 },
                'Algeria': { center: [28, 1], zoom: 4 },
                'Algerien': { center: [28, 1], zoom: 4 },
                'Morocco': { center: [32, -5], zoom: 4 },
                'Marokko': { center: [32, -5], zoom: 4 },
                'South Africa': { center: [-29, 24], zoom: 4 },
                'S√ºdafrika': { center: [-29, 24], zoom: 4 },
                'Nigeria': { center: [9, 8], zoom: 4 },
                'Kenya': { center: [-1, 37], zoom: 4 },
                'Kenia': { center: [-1, 37], zoom: 4 },
                'Ethiopia': { center: [9, 40], zoom: 4 },
                '√Ñthiopien': { center: [9, 40], zoom: 4 },
                
                // Ozeanien
                'Australia': { center: [-25, 133], zoom: 3 },
                'Australien': { center: [-25, 133], zoom: 3 },
                'New Zealand': { center: [-41, 174], zoom: 4 },
                'Neuseeland': { center: [-41, 174], zoom: 4 },
            };
            
            // Check if country has regional zoom settings
            if (regions[countryName]) {
                return regions[countryName];
            }
            
            // Default fallback based on geographical regions
            if (lat > 50 && lng > -10 && lng < 30) {
                return { center: [60, 15], zoom: 4 }; // Northern Europe
            } else if (lat > 35 && lat < 50 && lng > -10 && lng < 30) {
                return { center: [47, 10], zoom: 4 }; // Central Europe
            } else if (lat > 30 && lat < 45 && lng > -10 && lng < 50) {
                return { center: [40, 20], zoom: 4 }; // Southern Europe/Mediterranean
            } else if (lat > 10 && lat < 70 && lng > 20 && lng < 180) {
                return { center: [40, 80], zoom: 3 }; // Asia
            } else if (lat > -60 && lat < 15 && lng > -180 && lng < -30) {
                return { center: [-15, -60], zoom: 3 }; // South America
            } else if (lat > 15 && lat < 70 && lng > -180 && lng < -30) {
                return { center: [45, -100], zoom: 3 }; // North America
            } else if (lat > -40 && lat < 40 && lng > -20 && lng < 60) {
                return { center: [0, 20], zoom: 3 }; // Africa
            } else if (lat < -10 && lng > 110) {
                return { center: [-25, 140], zoom: 3 }; // Oceania
            }
            
            // Ultimate fallback
            return { center: [lat, lng], zoom: 5 };
        }

        // Function to zoom to country on map
        function zoomToCountryOnMap(countryName, lat, lng) {
            if (!pressMap || !lat || !lng) return;
            
            // Get regional zoom settings
            const zoomSettings = getRegionalZoom(countryName, lat, lng);
            
            // Zoom to regional view instead of specific country
            pressMap.setView(zoomSettings.center, zoomSettings.zoom, { animate: true, duration: 1.0 });
            
            // Find and highlight the country marker
            pressMap.eachLayer(function(layer) {
                if (layer.getPopup && layer.getPopup()) {
                    const popupContent = layer.getPopup().getContent();
                    if (popupContent.includes(countryName)) {
                        // Add a flash effect to the marker
                        if (layer.setStyle) {
                            const originalStyle = {
                                radius: layer.options.radius,
                                color: layer.options.color,
                                weight: layer.options.weight
                            };
                            
                            // Flash effect
                            layer.setStyle({ radius: 12, color: '#ff6b6b', weight: 4 });
                            setTimeout(() => {
                                layer.setStyle(originalStyle);
                                layer.openPopup();
                            }, 500);
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
